# 开发说明

## 项目结构说明

### 目录结构
- `src/` - 源代码目录，包含主程序文件
- `build/` - 构建和打包相关的脚本和配置文件
- `docs/` - 项目文档
- `dist/` - 打包输出目录（打包后自动生成）
- `venv_python/` - Python虚拟环境

### 核心文件
- `src/files_renames.py` - 主程序文件，包含完整的GUI应用
- `build/文件重命名工具.spec` - PyInstaller配置文件
- `build/version_info.txt` - Windows可执行文件版本信息

## 开发环境设置

### 1. 克隆项目
```bash
git clone <repository-url>
cd files-rename
```

### 2. 创建虚拟环境（可选）
```bash
python -m venv venv
venv\Scripts\activate  # Windows
```

### 3. 安装开发依赖
```bash
pip install pyinstaller  # 仅在需要打包时安装
```

### 4. 运行程序
```bash
python src/files_renames.py
```

## 代码结构

### 主要类和方法
- `OptimizedFileRenamer` - 主应用类
  - `__init__()` - 初始化界面和变量
  - `create_widgets()` - 创建GUI组件
  - `browse_folder()` - 文件夹选择功能
  - `preview_changes()` - 预览重命名操作
  - `execute_rename()` - 执行重命名操作
  - `create_backup_folder()` - 创建备份文件夹
  - `backup_file()` - 备份单个文件

### 功能模块
1. **GUI界面** - 使用tkinter创建现代化界面
2. **文件操作** - 使用os和shutil进行文件操作
3. **备份系统** - 自动创建时间戳备份文件夹
4. **错误处理** - 完善的异常处理和用户提示

## 打包说明

### 打包方式
1. **快速打包**：运行根目录的 `build.bat`
2. **详细打包**：进入 `build/` 目录运行相应脚本
3. **手动打包**：使用PyInstaller命令行

### 打包配置
- 使用 `--onefile` 生成单个可执行文件
- 使用 `--windowed` 隐藏控制台窗口
- 排除不必要的模块以减小文件大小
- 包含版本信息和图标（如果有）

### 优化选项
- `--optimize=2` - Python字节码优化
- `--strip` - 去除调试信息
- `--exclude-module` - 排除不需要的模块

## 版本管理

### 版本号规则
- 主版本号.次版本号.修订号
- 当前版本：2.0.0

### 更新版本
1. 修改 `build/version_info.txt` 中的版本信息
2. 更新 `README.md` 中的版本说明
3. 更新打包脚本中的文件名

## 测试

### 手动测试
1. 功能测试 - 验证所有功能正常工作
2. 界面测试 - 检查UI响应和显示
3. 错误测试 - 测试异常情况处理
4. 兼容性测试 - 在不同Windows版本上测试

### 测试用例
- 正常重命名操作
- 备份功能测试
- 文件冲突处理
- 权限不足处理
- 大量文件处理

## 发布流程

1. **代码审查** - 检查代码质量和功能完整性
2. **测试验证** - 完成所有测试用例
3. **版本更新** - 更新版本号和文档
4. **打包构建** - 生成可执行文件
5. **发布准备** - 准备发布说明和文档

## 贡献指南

### 代码规范
- 使用中文注释
- 遵循PEP 8代码风格
- 添加适当的错误处理
- 保持代码简洁易读

### 提交规范
- 使用清晰的提交信息
- 每次提交包含单一功能或修复
- 更新相关文档

## 常见问题

### 开发问题
**Q: 如何调试GUI应用？**
A: 可以在代码中添加print语句或使用IDE的调试功能。

**Q: 如何添加新功能？**
A: 在`OptimizedFileRenamer`类中添加新方法，并在界面中添加相应控件。

### 打包问题
**Q: 打包后文件太大怎么办？**
A: 检查`文件重命名工具.spec`中的排除模块列表，添加更多不需要的模块。

**Q: 打包失败怎么办？**
A: 检查PyInstaller版本，确保所有依赖都已安装，查看错误日志。
